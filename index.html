<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>SLER Visual Lab - Contraste Rítmico</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #fff; }
        .grid-test { display: flex; gap: 20px; margin-top: 20px; }
        .box { 
            flex: 1; border: 1px solid #000; padding: 15px; 
            min-height: 180px; background: #fafafa; white-space: pre-wrap; font-size: 16px;
        }
        .active-box { border: 2px solid #007bff; background: #fff; }
        .timer-display { font-size: 28px; font-weight: bold; margin: 10px 0; }
        .controls { margin: 20px 0; }
        button { padding: 10px 20px; cursor: pointer; font-family: monospace; font-weight: bold; }
        #resultsArea { margin-top: 30px; padding: 20px; background: #e9ecef; border-radius: 5px; display: none; }
        .comparison-label { font-weight: bold; margin-bottom: 5px; text-transform: uppercase; font-size: 12px; }
    </style>
</head>
<body>

    <h3>SLER-LAB: PROTOCOLO DE CONTRASTE SACÁDICO</h3>
    
    <div class="timer-display">TIEMPO ACTUAL: <span id="timer">0.000</span>s</div>

    <div class="controls">
        <button id="mainBtn" onclick="handleAction()">INICIAR TEST 1 (COMÚN)</button>
    </div>

    <div class="grid-test">
        <div>
            <div class="comparison-label">Referencia: Sistema Común</div>
            <div id="boxComun" class="box">Esperando inicio...</div>
        </div>
        <div>
            <div class="comparison-label">Ejecución: Sistema SLER</div>
            <div id="boxSler" class="box">Bloqueado hasta completar Test 1.</div>
        </div>
    </div>

    <div id="resultsArea">
        <h4>RESULTADOS DE LA COMPARATIVA</h4>
        <div id="finalStats"></div>
    </div>

<script>
    let startTime, timerInterval;
    let step = 0; // 0: inicio, 1: corriendo T1, 2: pausa/pre T2, 3: corriendo T2, 4: fin
    let times = [];

    const txtComun = "La lectura tradicional implica un salto brusco al final de cada renglón impreso.\nEste movimiento mecánico genera un vacío cognitivo llamado sacada de retorno.\nEl cerebro debe reubicar el foco visual perdiendo milisegundos en cada proceso.\nLa fatiga muscular ciliar aumenta proporcionalmente a la densidad del texto.";

    const txtSler = "La lectura tradicional implica un salto brusco al final de cada renglón- \n-impreso. Este movimiento mecánico genera un vacío cognitivo llamado- \n-sacada de retorno. El cerebro debe reubicar el foco visual perdiendo- \n-milisegundos en cada proceso. La fatiga muscular ciliar aumenta-";

    function handleAction() {
        const btn = document.getElementById('mainBtn');
        const timerDisp = document.getElementById('timer');

        if (step === 0) { // Inicia Test 1
            step = 1;
            document.getElementById('boxComun').innerText = txtComun;
            document.getElementById('boxComun').classList.add('active-box');
            btn.innerText = "LISTO (DETENER T1)";
            startClock();
        } 
        else if (step === 1) { // Fin Test 1
            stopClock();
            times.push(parseFloat(timerDisp.innerText));
            step = 2;
            btn.innerText = "INICIAR TEST 2 (SISTEMA SLER)";
            document.getElementById('boxComun').classList.remove('active-box');
            timerDisp.innerText = "0.000";
        }
        else if (step === 2) { // Inicia Test 2
            step = 3;
            document.getElementById('boxSler').innerText = txtSler;
            document.getElementById('boxSler').classList.add('active-box');
            btn.innerText = "LISTO (DETENER T2)";
            startClock();
        }
        else if (step === 3) { // Fin Test 2
            stopClock();
            times.push(parseFloat(timerDisp.innerText));
            step = 4;
            showResults();
            btn.style.display = 'none';
        }
    }

    function startClock() {
        startTime = performance.now();
        timerInterval = setInterval(() => {
            document.getElementById('timer').innerText = ((performance.now() - startTime) / 1000).toFixed(3);
        }, 10);
    }

    function stopClock() {
        clearInterval(timerInterval);
    }

    function showResults() {
        const diff = (times[0] - times[1]).toFixed(3);
        const percent = ((diff / times[0]) * 100).toFixed(1);
        const area = document.getElementById('resultsArea');
        const stats = document.getElementById('finalStats');

        area.style.display = 'block';
        stats.innerHTML = `
            <p>Tiempo Sistema Común: <strong>${times[0]}s</strong></p>
            <p>Tiempo Sistema SLER: <strong>${times[1]}s</strong></p>
            <p style="color: green; font-size: 18px;">
                Diferencia: ${diff}s | Optimización del flujo: <strong>${percent}%</strong>
            </p>
        `;
    }
</script>
</body>
</html>
